server {
	listen 80;
	server_name _ default;
	root /srv/public;
	index index.html;
	autoindex off;
	
	include inc/services_admin_page.inc;
	
	# Index html
	location /index.html {
		auth_basic "Auth";
		auth_basic_user_file inc/htpasswd.inc;
		break;
	}

	# Backend
	location /api/ {
		rewrite ^/. /api/index.php last;
	}
	location ~ ^/api/index.php$ {
		auth_basic "Auth";
		auth_basic_user_file inc/htpasswd.inc;
		root /srv/public;
		include fastcgi.conf;
		break;
	}

	# Frontend
	location / {
		auth_basic "Auth";
		auth_basic_user_file inc/htpasswd.inc;
		if (-f $request_filename) {
			break;
		}
		rewrite ^/. /index.html last;
	}
}